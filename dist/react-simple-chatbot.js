!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("styled-components")):"function"==typeof define&&define.amd?define(["react","styled-components"],t):"object"==typeof exports?exports.ReactSimpleChatbot=t(require("react"),require("styled-components")):e.ReactSimpleChatbot=t(e.react,e["styled-components"])}("undefined"!=typeof self?self:this,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=7)}([function(e,t,n){e.exports=n(5)()},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){var n=function(e,t){return{parse:function(t,r){var a=JSON.parse(t,i).map(o),s=a[0],u=r||n,c="object"==typeof s&&s?function t(n,r,o,i){return Object.keys(o).reduce((function(o,a){var s=o[a];if(s instanceof e){var u=n[s];"object"!=typeof u||r.has(u)?o[a]=i.call(o,a,u):(r.add(u),o[a]=i.call(o,a,t(n,r,u,i)))}else o[a]=i.call(o,a,s);return o}),o)}(a,new Set,s,u):s;return u.call({"":c},"",c)},stringify:function(e,t,o){for(var i,a=new Map,s=[],u=[],c=t&&typeof t==typeof s?function(e,n){if(""===e||-1<t.indexOf(e))return n}:t||n,l=+r(a,s,c.call({"":e},"",e)),p=function(e,t){if(i)return i=!i,t;var n=c.call(this,e,t);switch(typeof n){case"object":if(null===n)return n;case"string":return a.get(n)||r(a,s,n)}return n};l<s.length;l++)i=!0,u[l]=JSON.stringify(s[l],p,o);return"["+u.join(",")+"]"}};function n(e,t){return t}function r(t,n,r){var o=e(n.push(r)-1);return t.set(r,o),o}function o(t){return t instanceof e?e(t):t}function i(t,n){return"string"==typeof n?new e(n):n}}(String);e.exports=n},function(e,t,n){e.exports=function(e,t){var n=["abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ","0123456789","~!@#$%^&()_+-={}[];',"],r="";(t=t||"aA0").split("").forEach((function(e){isNaN(parseInt(e))?/[a-z]/.test(e)?r+=n[0]:/[A-Z]/.test(e)?r+=n[1]:r+=n[3]:r+=n[2]})),e=e||30;for(var o="";e--;)o+=r.charAt(Math.floor(Math.random()*r.length));return o}},function(e,t,n){"use strict";var r=n(6);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t),n.d(t,"Loading",(function(){return E}));var r,o,i,a,s=n(1),u=n.n(s),c=n(0),l=n.n(c),p=n(4),f=n.n(p),d=n(2),b=n.n(d),y=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=y(e);return"rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(t,")")};function g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var v,m=Object(d.keyframes)(r||(r=g(["\n  0% { opacity: .2; }\n  20% { opacity: 1; }\n  100% { opacity: .2; }\n"]))),S=Object(d.keyframes)(o||(o=g(["\n  100% { transform: scale(1); }\n"]))),O=Object(d.keyframes)(i||(i=g(["\n  25% { transform: rotate(-1deg); }\n  100% { transform: rotate(1deg); }\n"])));var x,w,j,k=b.a.span(v||(x=["\n  animation: "," 1.4s infinite both;\n  animation-delay: ",";\n"],w||(w=x.slice(0)),v=Object.freeze(Object.defineProperties(x,{raw:{value:Object.freeze(w)}}))),m,(function(e){return e.delay})),E=function(){return u.a.createElement("span",{className:"rsc-loading"},u.a.createElement(k,{delay:"0s"},"."),u.a.createElement(k,{delay:".2s"},"."),u.a.createElement(k,{delay:".4s"},"."))};var P=b.a.div(j||(j=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  background: #fff;\n  border-radius: 5px;\n  box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;\n  display: flex;\n  justify-content: center;\n  margin: 0 6px 10px 6px;\n  padding: 16px;\n"])));function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B(this,n)}}function B(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(i,e);var t,n,r,o=N(i);function i(){var e;C(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return M(I(e=o.call.apply(o,[this].concat(n))),"state",{loading:!0}),M(I(e),"renderComponent",(function(){var t=e.props,n=t.step,r=t.steps,o=t.previousStep,i=t.triggerNextStep,a=n.component;return u.a.cloneElement(a,{step:n,steps:r,previousStep:o,triggerNextStep:i})})),e}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.speak,r=t.step,o=t.previousValue,i=t.triggerNextStep,a=r.delay,s=r.waitAction;setTimeout((function(){e.setState({loading:!1},(function(){s||r.rendered||i(),n(r,o)}))}),a)}},{key:"render",value:function(){var e=this.state.loading,t=this.props.style;return u.a.createElement(P,{className:"rsc-cs",style:t},e?u.a.createElement(E,null):this.renderComponent())}}])&&q(t.prototype,n),r&&q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.Component);A.propTypes={previousStep:l.a.objectOf(l.a.any).isRequired,previousValue:l.a.oneOfType([l.a.string,l.a.bool,l.a.number,l.a.object,l.a.array]),speak:l.a.func,step:l.a.objectOf(l.a.any).isRequired,steps:l.a.objectOf(l.a.any).isRequired,style:l.a.objectOf(l.a.any).isRequired,triggerNextStep:l.a.func.isRequired},A.defaultProps={previousValue:"",speak:function(){}};var _,F=A;var V,D=b.a.li(_||(_=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  animation: "," 0.3s ease forwards;\n  cursor: pointer;\n  display: inline-block;\n  margin: 2px;\n  transform: scale(0);\n"])),S),L={background:"#f5f8fb",fontFamily:"monospace",headerBgColor:"#6e48aa",headerFontColor:"#fff",headerFontSize:"16px",botBubbleColor:"#6E48AA",botFontColor:"#fff",userBubbleColor:"#fff",userFontColor:"#4a4a4a"};var U=b.a.button(V||(V=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  background: ",";\n  border: 0;\n  border-radius: 22px;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.15);\n  color: ",";\n  display: inline-block;\n  font-size: 14px;\n  padding: 12px;\n\n  &:hover {\n    opacity: 0.7;\n  }\n  &:active,\n  &:hover:focus {\n    outline:none;\n  }\n"])),(function(e){return e.theme.botBubbleColor}),(function(e){return e.theme.botFontColor}));U.defaultProps={theme:L};var H,K=U;var W,J=b.a.ul(H||(H=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  margin: 2px 0 12px 0;\n  padding: 0 6px;\n"])));var Y=b.a.div(W||(W=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([""])));function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=re(e);if(t){var o=re(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){if(t&&("object"===$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ne(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(i,e);var t,n,r,o=ee(i);function i(){var e;G(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return oe(ne(e=o.call.apply(o,[this].concat(n))),"onOptionClick",(function(t){var n=t.value;(0,e.props.triggerNextStep)({value:n})})),oe(ne(e),"renderOption",(function(t){var n=e.props,r=n.bubbleOptionStyle,o=n.step.user,i=t.value,a=t.label,s=t.optionData;return u.a.createElement(D,{key:i,className:"rsc-os-option"},u.a.createElement(K,Z({className:"rsc-os-option-element",style:r,user:o,onClick:function(){return e.onOptionClick({value:i})}},s),a))})),e}return t=i,(n=[{key:"render",value:function(){var e=this.props.step.options;return u.a.createElement(Y,{className:"rsc-os"},u.a.createElement(J,{className:"rsc-os-options"},Object.keys(e).map((function(t){return e[t]})).map(this.renderOption)))}}])&&Q(t.prototype,n),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.Component);ie.propTypes={bubbleOptionStyle:l.a.objectOf(l.a.any).isRequired,step:l.a.objectOf(l.a.any).isRequired,triggerNextStep:l.a.func.isRequired};var ae,se=ie;var ue=b.a.div(ae||(ae=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  animation: "," 0.3s ease forwards;\n  background: ",";\n  border-radius: ",";\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.15);\n  color: ",";\n  display: inline-block;\n  font-size: 14px;\n  max-width: 50%;\n  margin: ",";\n  overflow: hidden;\n  position: relative;\n  padding: 12px;\n  transform: scale(0);\n  transform-origin: ",";\n"])),S,(function(e){return e.user?e.theme.userBubbleColor:e.theme.botBubbleColor}),(function(e){var t=e.isFirst,n=e.isLast,r=e.user;return t||n?!t&&n?r?"18px 0 18px 18px":"0 18px 18px 18px":e.user?"18px 18px 0 18px":"18px 18px 18px 0":r?"18px 0 0 18px":"0 18px 18px 0px"}),(function(e){return e.user?e.theme.userFontColor:e.theme.botFontColor}),(function(e){var t=e.isFirst,n=e.showAvatar,r=e.user;return!t&&n?r?"-8px 46px 10px 0":"-8px 0 10px 46px":t||n?"0 0 10px 0":r?"-8px 0px 10px 0":"-8px 0 10px 0px"}),(function(e){var t=e.isFirst,n=e.user;return t?n?"bottom right":"bottom left":n?"top right":"top left"}));ue.defaultProps={theme:L};var ce,le=ue;var pe,fe=b.a.img(ce||(ce=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  animation: "," 0.3s ease forwards;\n  border-radius: ",";\n  box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;\n  height: 40px;\n  min-width: 40px;\n  padding: 3px;\n  transform: scale(0);\n  transform-origin: ",";\n  width: 40;\n"])),S,(function(e){return e.user?"50% 50% 50% 0":"50% 50% 0 50%"}),(function(e){return e.user?"bottom left":"bottom right"}));var de,be=b.a.div(pe||(pe=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: inline-block;\n  order: ",";\n  padding: 6px;\n"])),(function(e){return e.user?"1":"0"}));var ye=b.a.div(de||(de=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  align-items: flex-end;\n  display: flex;\n  justify-content: ",";\n"])),(function(e){return e.user?"flex-end":"flex-start"}));function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=je(e);if(t){var o=je(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return we(e)}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}(i,e);var t,n,r,o=Oe(i);function i(){var e;ve(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ke(we(e=o.call.apply(o,[this].concat(n))),"state",{loading:!0}),ke(we(e),"getMessage",(function(){var t=e.props,n=t.previousValue,r=t.step.message;return r?r.replace(/{previousValue}/g,n):""})),ke(we(e),"renderMessage",(function(){var t=e.props,n=t.step,r=t.steps,o=t.previousStep,i=t.triggerNextStep,a=n.component;return a?u.a.cloneElement(a,{step:n,steps:r,previousStep:o,triggerNextStep:i}):e.getMessage()})),e}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.step,r=t.speak,o=t.previousValue,i=t.triggerNextStep,a=n.component,s=n.delay,u=n.waitAction,c=a&&u;setTimeout((function(){e.setState({loading:!1},(function(){c||n.rendered||i(),r(n,o)}))}),s)}},{key:"render",value:function(){var e=this.props,t=e.step,n=e.isFirst,r=e.isLast,o=e.avatarStyle,i=e.bubbleStyle,a=e.hideBotAvatar,s=e.hideUserAvatar,c=this.state.loading,l=t.avatar,p=t.user,f=t.botName,d=t.textData,b=p?!s:!a,y=p?"Your avatar":"".concat(f,"'s avatar");return u.a.createElement(ye,{className:"rsc-ts ".concat(p?"rsc-ts-user":"rsc-ts-bot"),user:p},u.a.createElement(be,{className:"rsc-ts-image-container",user:p},n&&b&&u.a.createElement(fe,{className:"rsc-ts-image",style:o,showAvatar:b,user:p,src:l,alt:y})),u.a.createElement(le,ge({className:"rsc-ts-bubble",style:i,user:p,showAvatar:b,isFirst:n,isLast:r},d),c?u.a.createElement(E,null):this.renderMessage()))}}])&&me(t.prototype,n),r&&me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.Component);Ee.propTypes={avatarStyle:l.a.objectOf(l.a.any).isRequired,isFirst:l.a.bool.isRequired,isLast:l.a.bool.isRequired,bubbleStyle:l.a.objectOf(l.a.any).isRequired,hideBotAvatar:l.a.bool.isRequired,hideUserAvatar:l.a.bool.isRequired,previousStep:l.a.objectOf(l.a.any),previousValue:l.a.oneOfType([l.a.string,l.a.bool,l.a.number,l.a.object,l.a.array]),speak:l.a.func,step:l.a.objectOf(l.a.any).isRequired,steps:l.a.objectOf(l.a.any),triggerNextStep:l.a.func.isRequired},Ee.defaultProps={previousStep:{},previousValue:"",speak:function(){},steps:{}};var Pe=Ee,ze=[{key:"id",types:["string","number"],required:!0},{key:"user",types:["boolean"],required:!0},{key:"hideExtraControl",types:["boolean"],required:!1},{key:"trigger",types:["string","number","function"],required:!1},{key:"validator",types:["function"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Ce=[{key:"id",types:["string","number"],required:!0},{key:"message",types:["string","function"],required:!0},{key:"textData",types:["object"],required:!1},{key:"avatar",types:["string"],required:!1},{key:"trigger",types:["string","number","function"],required:!1},{key:"delay",types:["number"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"hideExtraControl",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],qe=[{key:"id",types:["string","number"],required:!0},{key:"options",types:["object"],required:!0},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"hideExtraControl",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Re=[{key:"id",types:["string","number"],required:!0},{key:"component",types:["any"],required:!0},{key:"avatar",types:["string"],required:!1},{key:"replace",types:["boolean"],required:!1},{key:"waitAction",types:["boolean"],required:!1},{key:"asMessage",types:["boolean"],required:!1},{key:"trigger",types:["string","number","function"],required:!1},{key:"delay",types:["number"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"hideExtraControl",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Ne=[{key:"id",types:["string","number"],required:!0},{key:"update",types:["string","number"],required:!0},{key:"trigger",types:["string","number","function"],required:!0},{key:"placeholder",types:["string"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Be=n(3);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Te,Me={parse:function(e){var t=[];if(e.user)t=ze;else if(e.message)t=Ce;else if(e.options)t=qe;else if(e.component)t=Re;else{if(!e.update)throw new Error("The step ".concat(Object(Be.stringify)(e)," is invalid"));t=Ne}for(var n=0,r=t.length;n<r;n+=1){var o=t[n],i=o.key,a=o.types,s=o.required;if(!e[i]&&s)throw new Error("Key '".concat(i,"' is required in step ").concat(Object(Be.stringify)(e)));if(e[i]&&"any"!==a[0]&&a.indexOf(Ie(e[i]))<0)throw new Error("The type of '".concat(i,"' value must be ").concat(a.join(" or ")," instead of ").concat(Ie(e[i])))}var u=t.map((function(e){return e.key}));for(var c in e)u.indexOf(c)<0&&(console.error("Invalid key '".concat(c,"' in step '").concat(e.id,"'")),delete e[c]);return e},checkInvalidIds:function(e){for(var t in e){var n=e[t],r=e[t].trigger;if("function"!=typeof r)if(n.options)for(var o=n.options.filter((function(e){return"function"!=typeof e.trigger})).map((function(e){return e.trigger})),i=0,a=o.length;i<a;i+=1){var s=o[i];if(s&&!e[s])throw new Error("The id '".concat(s,"' triggered by option ").concat(i+1," in step '").concat(e[t].id,"' does not exist"))}else if(r&&!e[r])throw new Error("The id '".concat(r,"' triggered by step '").concat(e[t].id,"' does not exist"))}}};var Ae=b.a.div(Te||(Te=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  background: ",";\n  border-radius: 10px;\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);\n  font-family: ",";\n  overflow: hidden;\n  position: ",";\n  bottom: ",";\n  top: ",";\n  right: ",";\n  left: ",";\n  width: ",";\n  height: ",";\n  z-index: 999;\n  transform: ",";\n  transform-origin: ",";\n  transition: transform 0.3s ease;\n\n  @media screen and (max-width: 568px) {\n    border-radius: ",";\n    bottom: 0 !important;\n    left: initial !important;\n    height: 100%;\n    right: 0 !important;\n    top: initial !important;\n    width: 100%;\n  }\n"])),(function(e){return e.theme.background}),(function(e){return e.theme.fontFamily}),(function(e){return e.floating?"fixed":"relative"}),(function(e){var t=e.floating,n=e.floatingStyle;return t?n.bottom||"32px":"initial"}),(function(e){var t=e.floating,n=e.floatingStyle;return t&&n.top||"initial"}),(function(e){var t=e.floating,n=e.floatingStyle;return t?n.right||"32px":"initial"}),(function(e){var t=e.floating,n=e.floatingStyle;return t&&n.left||"initial"}),(function(e){return e.width}),(function(e){return e.height}),(function(e){return e.opened?"scale(1)":"scale(0)"}),(function(e){return e.floatingStyle.transformOrigin||"bottom right"}),(function(e){return e.floating?"0":""}));Ae.defaultProps={theme:L};var _e,Fe=Ae;var Ve,De=b.a.div(_e||(_e=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  height: calc("," - ",");\n  overflow-y: scroll;\n  margin-top: 2px;\n  padding-top: 6px;\n\n  @media screen and (max-width: 568px) {\n    height: ",";\n  }\n"])),(function(e){return e.height}),(function(e){return e.hideInput?"56px":"112px"}),(function(e){return e.floating?"calc(100% - 112px)":""}));var Le=b.a.div(Ve||(Ve=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  align-items: center;\n  background: ",";\n  color: ",";\n  display: flex;\n  fill: ",";\n  height: 56px;\n  justify-content: space-between;\n  padding: 0 10px;\n"])),(function(e){return e.theme.headerBgColor}),(function(e){return e.theme.headerFontColor}),(function(e){return e.theme.headerFontColor}));Le.defaultProps={theme:L};var Ue,He=Le;var Ke=b.a.h2(Ue||(Ue=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  margin: 0;\n  font-size: ",";\n"])),(function(e){return e.theme.headerFontSize}));Ke.defaultProps={theme:L};var We,Je=Ke;var Ye,$e=b.a.a(We||(We=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  cursor: pointer;\n"])));var Ze=b.a.a(Ye||(Ye=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  align-items: center;\n  cursor: pointer;\n  background: ",";\n  bottom: 32px;\n  border-radius: 100%;\n  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);\n  display: flex;\n  fill: ",";\n  height: 56px;\n  justify-content: center;\n  position: fixed;\n  right: 32px;\n  transform: ",";\n  transition: transform 0.3s ease;\n  width: 56px;\n  z-index: 999;\n"])),(function(e){return e.theme.headerBgColor}),(function(e){return e.theme.headerFontColor}),(function(e){return e.opened?"scale(0)":"scale(1)"}));Ze.defaultProps={theme:{headerBgColor:"#6e48aa",headerFontColor:"#fff"}};var Ge,Qe=Ze;var Xe,et=b.a.img(Ge||(Ge=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  height: 24px;\n  width: 24px;\n"])));var tt,nt,rt=b.a.div(Xe||(Xe=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  position: relative;\n"])));function ot(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var it,at,st=b.a.input(tt||(tt=ot(["\n  animation: ",";\n  border: 0;\n  border-radius: 0;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n  border-top: ",";\n  box-shadow: ",";\n  box-sizing: border-box;\n  color: ",";\n  font-size: 16px;\n  opacity: ",";\n  outline: none;\n  padding: ",";\n  width: 100%;\n  -webkit-appearance: none;\n\n  &:disabled {\n    background: #fff;\n  }\n\n  @media screen and (max-width: 568px) {\n    border-bottom-left-radius: ",";\n    border-bottom-right-radius: ",";\n  }\n"])),(function(e){return e.invalid?Object(d.css)(nt||(nt=ot(["\n          "," .2s ease\n        "])),O):""}),(function(e){return e.invalid?"0":"1px solid #eee"}),(function(e){return e.invalid?"inset 0 0 2px #E53935":"none"}),(function(e){return e.invalid?"#E53935":""}),(function(e){return e.disabled&&!e.invalid?".5":"1"}),(function(e){return e.hasButton?"16px 52px 16px 10px":"16px 10px"}),(function(e){return e.floating?"0":"10px"}),(function(e){return e.floating?"0":"10px"}));function ut(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ct=b.a.button(it||(it=ut(["\n  background-color: transparent;\n  border: 0;\n  border-bottom-right-radius: 10px;\n  box-shadow: none;\n  cursor: ",";\n  fill: ",";\n  opacity: ",";\n  outline: none;\n  padding: 14px 16px 12px 16px;\n  &:before {\n    content: '';\n    position: absolute;\n    width: 23px;\n    height: 23px;\n    border-radius: 50%;\n    animation: ",";\n  }\n  &:not(:disabled):hover {\n    opacity: 0.7;\n  }\n"])),(function(e){return e.disabled?"default":"pointer"}),(function(e){var t=e.speaking,n=e.invalid,r=e.theme;return t?r.headerBgColor:n?"#E53935":"#4a4a4a"}),(function(e){return e.disabled&&!e.invalid?".5":"1"}),(function(e){var t,n=e.theme;return e.speaking?Object(d.css)(at||(at=ut(["\n            "," 2s ease infinite\n          "])),(t=n.headerBgColor,Object(d.keyframes)(a||(a=g(["\n  0% { box-shadow: 0 0 0 0 ","; }\n  70% { box-shadow: 0 0 0 10px ","; }\n  100% { box-shadow: 0 0 0 0 ","; }\n"])),h(t,.4),h(t,0),h(t,0)))):""}));ct.defaultProps={theme:L};var lt=ct;function pt(){return(pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bt=null,yt=function(){},ht=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yt,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yt,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en";return ft(this,e),bt||(bt=this),this.state={inputValue:"",lang:o,onChange:t,onEnd:n,onStop:r},this.onResult=this.onResult.bind(this),this.onEnd=this.onEnd.bind(this),this.setup(),bt}var t,n,r;return t=e,r=[{key:"isSupported",value:function(){return"webkitSpeechRecognition"in window}}],(n=[{key:"onChange",value:function(e){var t=this.state.onChange;this.setState({inputValue:e}),t(e)}},{key:"onFinal",value:function(e){this.setState({inputValue:e}),this.recognition.stop()}},{key:"onEnd",value:function(){var e=this.state,t=e.onStop,n=e.onEnd,r=e.force;this.setState({speaking:!1}),r?t():n()}},{key:"onResult",value:function(e){for(var t="",n="",r=e.resultIndex;r<e.results.length;r+=1)e.results[r].isFinal?(n+=e.results[r][0].transcript,this.onFinal(n)):(t+=e.results[r][0].transcript,this.onChange(t))}},{key:"setState",value:function(e){this.state=pt({},this.state,e)}},{key:"setup",value:function(){if(!e.isSupported())return this;var t=window.webkitSpeechRecognition;return this.recognition=new t,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang=this.state.lang,this.recognition.onresult=this.onResult,this.recognition.onend=this.onEnd,this}},{key:"setLang",value:function(e){return this.setState({lang:e}),this.setup(),this}},{key:"speak",value:function(){return e.isSupported()?(this.state.speaking?(this.setState({force:!0}),this.recognition.stop()):(this.recognition.start(),this.setState({speaking:!0,inputValue:""})),this):this}}])&&dt(t.prototype,n),r&&dt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),gt=function(){return u.a.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},u.a.createElement("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"}),u.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},vt=function(){return u.a.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},u.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),u.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},mt=function(e){var t=e.size;return u.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 500 500"},u.a.createElement("g",null,u.a.createElement("g",null,u.a.createElement("polygon",{points:"0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75"}))))};mt.propTypes={size:l.a.number},mt.defaultProps={size:20};var St=mt,Ot=function(e){var t=e.size;return u.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 400 400"},u.a.createElement("g",null,u.a.createElement("path",{d:"M290.991,240.991c0,26.392-21.602,47.999-48.002,47.999h-11.529c-26.4,0-48.002-21.607-48.002-47.999V104.002   c0-26.4,21.602-48.004,48.002-48.004h11.529c26.4,0,48.002,21.604,48.002,48.004V240.991z"}),u.a.createElement("path",{d:"M342.381,209.85h-8.961c-4.932,0-8.961,4.034-8.961,8.961v8.008c0,50.26-37.109,91.001-87.361,91.001   c-50.26,0-87.109-40.741-87.109-91.001v-8.008c0-4.927-4.029-8.961-8.961-8.961h-8.961c-4.924,0-8.961,4.034-8.961,8.961v8.008   c0,58.862,40.229,107.625,96.07,116.362v36.966h-34.412c-4.932,0-8.961,4.039-8.961,8.971v17.922c0,4.923,4.029,8.961,8.961,8.961   h104.688c4.926,0,8.961-4.038,8.961-8.961v-17.922c0-4.932-4.035-8.971-8.961-8.971h-34.43v-36.966   c55.889-8.729,96.32-57.5,96.32-116.362v-8.008C351.342,213.884,347.303,209.85,342.381,209.85z"})))};Ot.propTypes={size:l.a.number},Ot.defaultProps={size:20};var xt=Ot,wt=function(){return/iphone|ipod|android|ie|blackberry|fennec/i.test(navigator.userAgent)},jt=function(e){return"string"==typeof e},kt=function(e){return function(t,n){var r=e.lang,o=e.voice,i=e.enable,a=t.user;if(window.SpeechSynthesisUtterance&&window.speechSynthesis&&!a&&i){var s=function(e){var t=e.message,n=e.metadata,r=void 0===n?{}:n;return jt(r.speak)?r.speak:jt(t)?t:""}(t),u=new window.SpeechSynthesisUtterance;u.text=s.replace(/{previousValue}/g,n),u.lang=r,u.voice=o,window.speechSynthesis.speak(u)}}};function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){Mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tt(e);if(t){var o=Tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bt(this,n)}}function Bt(e,t){if(t&&("object"===Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return It(e)}function It(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(e){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rt(e,t)}(i,e);var t,n,r,o=Nt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Mt(It(t=o.call(this,e)),"onNodeInserted",(function(e){var n=e.currentTarget;t.props.enableSmoothScroll&&t.supportsScrollBehavior?n.scroll({top:n.scrollHeight,left:0,behavior:"smooth"}):n.scrollTop=n.scrollHeight})),Mt(It(t),"onResize",(function(){t.content.scrollTop=t.content.scrollHeight})),Mt(It(t),"onRecognitionChange",(function(e){t.setState({inputValue:e})})),Mt(It(t),"onRecognitionEnd",(function(){t.setState({speaking:!1}),t.handleSubmitButton()})),Mt(It(t),"onRecognitionStop",(function(){t.setState({speaking:!1})})),Mt(It(t),"onValueChange",(function(e){t.setState({inputValue:e.target.value})})),Mt(It(t),"getTriggeredStep",(function(e,n){var r=t.generateRenderedStepsById();return"function"==typeof e?e({value:n,steps:r}):e})),Mt(It(t),"getStepMessage",(function(e){var n=t.state.previousSteps,r=n.length>0?n.length-1:0,o=t.generateRenderedStepsById(),i=n[r].value;return"function"==typeof e?e({previousValue:i,steps:o}):e})),Mt(It(t),"generateRenderedStepsById",(function(){for(var e=t.state.previousSteps,n={},r=0,o=e.length;r<o;r+=1){var i=e[r],a=i.id,s=i.message,u=i.value,c=i.metadata;n[a]={id:a,message:s,value:u,metadata:c}}return n})),Mt(It(t),"triggerNextStep",(function(e){var n=t.props.enableMobileAutoFocus,r=t.state,o=r.defaultUserSettings,i=r.previousSteps,a=r.renderedSteps,s=r.steps,u=t.state,c=u.currentStep,l=u.previousStep,p=c.end;if(e&&e.value&&(c.value=e.value),e&&e.hideInput&&(c.hideInput=e.hideInput),e&&e.hideExtraControl&&(c.hideExtraControl=e.hideExtraControl),e&&e.trigger&&(c.trigger=t.getTriggeredStep(e.trigger,e.value)),p)t.handleEnd();else if(c.options&&e){var d=c.options.filter((function(t){return t.value===e.value}))[0],b=t.getTriggeredStep(d.trigger,c.value);delete c.options,c=Ct({},c,d,o,{user:!0,message:d.label,trigger:b}),a.pop(),i.pop(),a.push(c),i.push(c),t.setState({currentStep:c,renderedSteps:a,previousSteps:i})}else if(c.trigger){c.replace&&a.pop();var y=Ct({},s[t.getTriggeredStep(c.trigger,c.value)]);if(y.message)y.message=t.getStepMessage(y.message);else if(y.update){var h=y;if((y=Ct({},s[h.update])).options)for(var g=0,v=y.options.length;g<v;g+=1)y.options[g].trigger=h.trigger;else y.trigger=h.trigger}y.key=f()(24),l=c,c=y,t.setState({renderedSteps:a,currentStep:c,previousStep:l},(function(){y.user?t.setState({disabled:!1},(function(){!n&&wt()||t.input&&t.input.focus()})):(a.push(y),i.push(y),t.setState({renderedSteps:a,previousSteps:i}))}))}var m=t.props,S=m.cache,O=m.cacheName;S&&setTimeout((function(){!function(e,t){var n=Object(Be.parse)(Object(Be.stringify)(t));for(var r in n)for(var o=0,i=n[r].length;o<i;o+=1)n[r][o].component&&(n[r][o].component=n[r][o].id);localStorage.setItem(e,Object(Be.stringify)(n))}(O,{currentStep:c,previousStep:l,previousSteps:i,renderedSteps:a})}),300)})),Mt(It(t),"handleEnd",(function(){var e=t.props.handleEnd;if(e){for(var n=t.state.previousSteps,r=n.map((function(e){return{id:e.id,message:e.message,value:e.value,metadata:e.metadata}})),o=[],i=0,a=n.length;i<a;i+=1){var s=n[i],u=s.id,c=s.message,l=s.value,p=s.metadata;o[u]={id:u,message:c,value:l,metadata:p}}e({renderedSteps:r,steps:o,values:n.filter((function(e){return e.value})).map((function(e){return e.value}))})}})),Mt(It(t),"isInputValueEmpty",(function(){var e=t.state.inputValue;return!e||0===e.length})),Mt(It(t),"isLastPosition",(function(e){var n=t.state.renderedSteps,r=n.length,o=n.map((function(e){return e.key})).indexOf(e.key);if(r<=1||o+1===r)return!0;var i=n[o+1];return!i.message&&!i.asMessage||e.user!==i.user})),Mt(It(t),"isFirstPosition",(function(e){var n=t.state.renderedSteps,r=n.map((function(e){return e.key})).indexOf(e.key);if(0===r)return!0;var o=n[r-1];return!o.message&&!o.asMessage||e.user!==o.user})),Mt(It(t),"handleKeyPress",(function(e){"Enter"===e.key&&t.submitUserMessage()})),Mt(It(t),"handleSubmitButton",(function(){var e=t.state,n=e.speaking,r=e.recognitionEnable;if((t.isInputValueEmpty()||n)&&r)return t.recognition.speak(),void(n||t.setState({speaking:!0}));t.submitUserMessage()})),Mt(It(t),"submitUserMessage",(function(){var e=t.state,n=e.defaultUserSettings,r=e.inputValue,o=e.previousSteps,i=e.renderedSteps,a=t.state.currentStep;a.validator&&t.checkInvalidInput()||(a=Ct({},n,a,{message:r,value:r}),i.push(a),o.push(a),t.setState({currentStep:a,renderedSteps:i,previousSteps:o,disabled:!0,inputValue:""},(function(){t.input&&t.input.blur()})))})),Mt(It(t),"checkInvalidInput",(function(){var e=t.props.enableMobileAutoFocus,n=t.state,r=n.currentStep,o=n.inputValue,i=r.validator(o),a=o;return("boolean"!=typeof i||!i)&&(t.setState({inputValue:i.toString(),inputInvalid:!0,disabled:!0},(function(){setTimeout((function(){t.setState({inputValue:a,inputInvalid:!1,disabled:!1},(function(){!e&&wt()||t.input&&t.input.focus()}))}),2e3)})),!0)})),Mt(It(t),"toggleChatBot",(function(e){var n=t.props.toggleFloating;n?n({opened:e}):t.setState({opened:e})})),Mt(It(t),"renderStep",(function(e,n){var r=t.state.renderedSteps,o=t.props,i=o.avatarStyle,a=o.bubbleStyle,s=o.bubbleOptionStyle,c=o.customStyle,l=o.hideBotAvatar,p=o.hideUserAvatar,f=o.speechSynthesis,d=e.options,b=e.component,y=e.asMessage,h=t.generateRenderedStepsById(),g=n>0?r[n-1]:{};return b&&!y?u.a.createElement(F,{key:n,speak:t.speak,step:e,steps:h,style:c,previousStep:g,previousValue:g.value,triggerNextStep:t.triggerNextStep}):d?u.a.createElement(se,{key:n,step:e,previousValue:g.value,triggerNextStep:t.triggerNextStep,bubbleOptionStyle:s}):u.a.createElement(Pe,{key:n,step:e,steps:h,speak:t.speak,previousStep:g,previousValue:g.value,triggerNextStep:t.triggerNextStep,avatarStyle:i,bubbleStyle:a,hideBotAvatar:l,hideUserAvatar:p,speechSynthesis:f,isFirst:t.isFirstPosition(e),isLast:t.isLastPosition(e)})})),t.content=null,t.input=null,t.supportsScrollBehavior=!1,t.setContentRef=function(e){t.content=e},t.setInputRef=function(e){t.input=e},t.state={renderedSteps:[],previousSteps:[],currentStep:{},previousStep:{},steps:{},disabled:!0,opened:e.opened||!e.floating,inputValue:"",inputInvalid:!1,speaking:!1,recognitionEnable:e.recognitionEnable&&ht.isSupported(),defaultUserSettings:{}},t.speak=kt(e.speechSynthesis),t}return t=i,r=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.opened;return void 0!==e.toggleFloating&&void 0!==n&&n!==t.opened?zt(zt({},t),{},{opened:n}):t}}],(n=[{key:"componentDidMount",value:function(){for(var e=this,t=this.props.steps,n=this.props,r=n.botDelay,o=n.botAvatar,i=n.botName,a=n.cache,s=n.cacheName,u=n.customDelay,c=n.enableMobileAutoFocus,l=n.userAvatar,p={},f={delay:r,avatar:o,botName:i},d={delay:n.userDelay,avatar:l,hideInput:!1,hideExtraControl:!1},b={delay:u},y=0,h=t.length;y<h;y+=1){var g=t[y],v={};g.user?v=d:g.message||g.asMessage?v=f:g.component&&(v=b),p[g.id]=Ct({},v,Me.parse(g))}Me.checkInvalidIds(p);var m=t[0];if(m.message){var S=m.message;m.message="function"==typeof S?S():S,p[m.id].message=m.message}var O=this.state.recognitionEnable,x=this.props.recognitionLang;O&&(this.recognition=new ht(this.onRecognitionChange,this.onRecognitionEnd,this.onRecognitionStop,x)),this.supportsScrollBehavior="scrollBehavior"in document.documentElement.style,this.content&&(this.content.addEventListener("DOMNodeInserted",this.onNodeInserted),window.addEventListener("resize",this.onResize));var w=function(e,t){var n=e.cacheName,r=e.cache,o=e.firstStep,i=e.steps,a=o,s=[i[a.id]],u=[i[a.id]],c=localStorage.getItem(n);if(r&&c)try{var l=Object(Be.parse)(c),p=l.renderedSteps[l.renderedSteps.length-1];if(!p||!p.end){for(var f=0,d=l.renderedSteps.length;f<d;f+=1){var b=l.renderedSteps[f];if(l.renderedSteps[f].delay=0,l.renderedSteps[f].rendered=!0,b.component){var y=b.id;l.renderedSteps[f].component=i[y].component}}var h=l.currentStep,g=h.trigger,v=h.end,m=h.options,S=l.currentStep.id;if(m&&delete l.currentStep.rendered,!g&&!v)if(m)for(var O=0;O<m.length;O+=1)l.currentStep.options[O].trigger=i[S].options[O].trigger;else l.currentStep.trigger=i[S].trigger;return l.currentStep.user&&t(),l}localStorage.removeItem(n)}catch(e){console.info("Unable to parse cache named:".concat(n,". \nThe cache where probably created with an older version of react-simple-chatbot.\n"),e)}return{currentStep:a,previousStep:{},previousSteps:u,renderedSteps:s}}({cacheName:s,cache:a,firstStep:m,steps:p},(function(){e.setState({disabled:!1},(function(){!c&&wt()||e.input&&e.input.focus()}))})),j=w.currentStep,k=w.previousStep,E=w.previousSteps,P=w.renderedSteps;this.setState({currentStep:j,defaultUserSettings:d,previousStep:k,previousSteps:E,renderedSteps:P,steps:p})}},{key:"componentWillUnmount",value:function(){this.content&&(this.content.removeEventListener("DOMNodeInserted",this.onNodeInserted),window.removeEventListener("resize",this.onResize))}},{key:"render",value:function(){var e,t=this,n=this.state,r=n.currentStep,o=n.disabled,i=n.inputInvalid,a=n.inputValue,s=n.opened,c=n.renderedSteps,l=n.speaking,p=n.recognitionEnable,f=this.props,d=f.className,b=f.contentStyle,y=f.extraControl,h=f.controlStyle,g=f.floating,v=f.floatingIcon,m=f.floatingStyle,S=f.footerStyle,O=f.headerComponent,x=f.headerTitle,w=f.hideHeader,j=f.hideSubmitButton,k=f.inputStyle,E=f.placeholder,P=f.inputAttributes,z=f.recognitionPlaceholder,C=f.style,q=f.submitButtonStyle,R=f.width,N=f.height,B=O||u.a.createElement(He,{className:"rsc-header"},u.a.createElement(Je,{className:"rsc-header-title"},x),g&&u.a.createElement($e,{className:"rsc-header-close-button",onClick:function(){return t.toggleChatBot(!1)}},u.a.createElement(vt,null)));void 0!==y&&(e=u.a.cloneElement(y,{disabled:o,speaking:l,invalid:i}));var I=(this.isInputValueEmpty()||l)&&p?u.a.createElement(xt,null):u.a.createElement(St,null),T=l?z:r.placeholder||E,M=r.inputAttributes||P;return u.a.createElement("div",{className:"rsc ".concat(d)},g&&u.a.createElement(Qe,{className:"rsc-float-button",style:m,opened:s,onClick:function(){return t.toggleChatBot(!0)}},"string"==typeof v?u.a.createElement(et,{src:v}):v),u.a.createElement(Fe,{className:"rsc-container",floating:g,floatingStyle:m,opened:s,style:C,width:R,height:N},!w&&B,u.a.createElement(De,{className:"rsc-content",ref:this.setContentRef,floating:g,style:b,height:N,hideInput:r.hideInput},c.map(this.renderStep)),u.a.createElement(rt,{className:"rsc-footer",style:S},!r.hideInput&&u.a.createElement(st,Ct({type:"textarea",style:k,ref:this.setInputRef,className:"rsc-input",placeholder:i?"":T,onKeyPress:this.handleKeyPress,onChange:this.onValueChange,value:a,floating:g,invalid:i,disabled:o,hasButton:!j},M)),u.a.createElement("div",{style:h,className:"rsc-controls"},!r.hideInput&&!r.hideExtraControl&&e,!r.hideInput&&!j&&u.a.createElement(lt,{className:"rsc-submit-button",style:q,onClick:this.handleSubmitButton,invalid:i,disabled:o,speaking:l},I)))))}}])&&qt(t.prototype,n),r&&qt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.Component);At.propTypes={avatarStyle:l.a.objectOf(l.a.any),botAvatar:l.a.string,botName:l.a.string,botDelay:l.a.number,bubbleOptionStyle:l.a.objectOf(l.a.any),bubbleStyle:l.a.objectOf(l.a.any),cache:l.a.bool,cacheName:l.a.string,className:l.a.string,contentStyle:l.a.objectOf(l.a.any),customDelay:l.a.number,customStyle:l.a.objectOf(l.a.any),controlStyle:l.a.objectOf(l.a.any),enableMobileAutoFocus:l.a.bool,enableSmoothScroll:l.a.bool,extraControl:l.a.objectOf(l.a.element),floating:l.a.bool,floatingIcon:l.a.oneOfType([l.a.string,l.a.element]),floatingStyle:l.a.objectOf(l.a.any),footerStyle:l.a.objectOf(l.a.any),handleEnd:l.a.func,headerComponent:l.a.element,headerTitle:l.a.string,height:l.a.string,hideBotAvatar:l.a.bool,hideHeader:l.a.bool,hideSubmitButton:l.a.bool,hideUserAvatar:l.a.bool,inputAttributes:l.a.objectOf(l.a.any),inputStyle:l.a.objectOf(l.a.any),opened:l.a.bool,toggleFloating:l.a.func,placeholder:l.a.string,recognitionEnable:l.a.bool,recognitionLang:l.a.string,recognitionPlaceholder:l.a.string,speechSynthesis:l.a.shape({enable:l.a.bool,lang:l.a.string,voice:"undefined"!=typeof window?l.a.instanceOf(window.SpeechSynthesisVoice):l.a.any}),steps:l.a.arrayOf(l.a.object).isRequired,style:l.a.objectOf(l.a.any),submitButtonStyle:l.a.objectOf(l.a.any),userAvatar:l.a.string,userDelay:l.a.number,width:l.a.string},At.defaultProps={avatarStyle:{},botDelay:1e3,botName:"The bot",bubbleOptionStyle:{},bubbleStyle:{},cache:!1,cacheName:"rsc_cache",className:"",contentStyle:{},customStyle:{},controlStyle:{position:"absolute",right:"0",top:"0"},customDelay:1e3,enableMobileAutoFocus:!1,enableSmoothScroll:!1,extraControl:void 0,floating:!1,floatingIcon:u.a.createElement(gt,null),floatingStyle:{},footerStyle:{},handleEnd:void 0,headerComponent:void 0,headerTitle:"Chat",height:"520px",hideBotAvatar:!1,hideHeader:!1,hideSubmitButton:!1,hideUserAvatar:!1,inputStyle:{},opened:void 0,placeholder:"Type the message ...",inputAttributes:{},recognitionEnable:!1,recognitionLang:"en",recognitionPlaceholder:"Listening ...",speechSynthesis:{enable:!1,lang:"en",voice:null},style:{},submitButtonStyle:{},toggleFloating:void 0,userDelay:1e3,width:"350px",botAvatar:"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e",userAvatar:"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e"};var _t=At;t.default=_t}])}));
//# sourceMappingURL=react-simple-chatbot.js.map